(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7282],{1816:(e,t,a)=>{Promise.resolve().then(a.bind(a,4392))},2383:()=>{},3686:()=>{},4392:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var s=a(5155),r=a(2115),l=a(2355),n=a(3052),c=a(381),i=a(9869),d=a(505),o=a(7924),u=a(9917),h=a(2525),x=a(285),p=a(2523),m=a(5127),v=a(9409),j=a(6126),g=a(6695),y=a(5057),f=a(4261),_=a(646),N=a(5339),b=a(3925),C=a(4165),w=a(5863),R=a(9434);function A(e){let{className:t,value:a,...r}=e;return(0,s.jsx)(w.bL,{"data-slot":"progress",className:(0,R.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...r,children:(0,s.jsx)(w.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})}var S=a(5365);let F=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE"],T=["Standard","Reduced","Super Reduced","Zero Rate","Exempt"];var k=a(6671),V=a(9586);let E=e=>{let{open:t,onOpenChange:a,onImportSuccess:l}=e,[n,c]=(0,r.useState)(!1),[i,d]=(0,r.useState)(0),[o,u]=(0,r.useState)(null),h=(e,t)=>{let a=[];return e.product_type&&"string"==typeof e.product_type||a.push("Row ".concat(t+1,": Product type is required")),e.country&&F.includes(e.country)||a.push("Row ".concat(t+1,": Valid EU country is required")),e.vat_category&&T.includes(e.vat_category)||a.push("Row ".concat(t+1,": Valid VAT category is required")),(isNaN(Number(e.vat_rate))||0>Number(e.vat_rate)||Number(e.vat_rate)>100)&&a.push("Row ".concat(t+1,": VAT rate must be a number between 0 and 100")),(isNaN(Number(e.shipping_vat_rate))||0>Number(e.shipping_vat_rate)||Number(e.shipping_vat_rate)>100)&&a.push("Row ".concat(t+1,": Shipping VAT rate must be a number between 0 and 100")),{isValid:0===a.length,errors:a}},m=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){c(!0),d(0),u(null);try{let e=await a.arrayBuffer(),t=b.LF(e),s=t.Sheets[t.SheetNames[0]],r=b.Wp.sheet_to_json(s);d(25);let n=[],c=[];if(r.forEach((e,t)=>{let a=h(e,t);a.isValid?n.push({id:"import_".concat(Date.now(),"_").concat(t),product_type:e.product_type,country:e.country,vat_rate:Number(e.vat_rate),vat_category:e.vat_category,shipping_vat_rate:Number(e.shipping_vat_rate)}):c.push(...a.errors),d(25+t/r.length*50)}),d(75),n.length>0){try{let e=await V.A.post("/imports/products/json",{products:n.map(e=>{let{id:t,...a}=e;return a})});k.oR.success("Saved ".concat(e.data.imported," tax rules to the database."))}catch(e){console.error("Failed to import to server:",e),k.oR.error("Failed to save imported tax rules to server.")}l(n)}d(100),u({success:n.length,errors:c,total:r.length}),n.length>0&&k.oR.success("Successfully imported ".concat(n.length," tax rules.")),c.length>0&&k.oR.error("".concat(c.length," errors found. Check the results below."))}catch(t){let e=t instanceof Error?t.message:"Unknown error";u({success:0,errors:["Failed to parse Excel file: ".concat(e)],total:0}),k.oR.error("Failed to process Excel file: ".concat(e))}finally{c(!1),e.target.value=""}}};return(0,s.jsx)(C.lG,{open:t,onOpenChange:()=>{u(null),d(0),a(!1)},children:(0,s.jsxs)(C.Cf,{className:"max-w-2xl",children:[(0,s.jsx)(C.c7,{children:(0,s.jsx)(C.L3,{className:"flex items-center gap-2",children:"Import Tax Rules from Excel"})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{children:"Download Template"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download the Excel template with the correct column format"}),(0,s.jsxs)(x.$,{variant:"outline",onClick:()=>{let e=b.Wp.json_to_sheet([{product_type:"Electronics",country:"Germany",vat_rate:19,vat_category:"Standard",shipping_vat_rate:19},{product_type:"Books",country:"France",vat_rate:5.5,vat_category:"Reduced",shipping_vat_rate:20}]),t=b.Wp.book_new();b.Wp.book_append_sheet(t,e,"Tax Rules Template"),b._h(t,"tax_rules_template.xlsx"),k.oR.success("Template Downloaded")},children:[(0,s.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"excel-upload",children:"Upload Excel File"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select an Excel file (.xlsx, .xls) with tax rules data"}),(0,s.jsx)(p.p,{id:"excel-upload",type:"file",accept:".xlsx,.xls",onChange:m,disabled:n,className:"cursor-pointer"})]}),n&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{children:"Import Progress"}),(0,s.jsx)(A,{value:i,className:"w-full"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Processing... ",Math.round(i),"%"]})]}),o&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[o.success>0?(0,s.jsx)(_.A,{className:"h-5 w-5 text-green-500"}):(0,s.jsx)(N.A,{className:"h-5 w-5 text-red-500"}),(0,s.jsx)(y.J,{children:"Import Results"})]}),o.success>0&&(0,s.jsxs)(S.Fc,{children:[(0,s.jsx)(_.A,{className:"h-4 w-4"}),(0,s.jsxs)(S.TN,{children:["Successfully imported ",o.success," out of ",o.total," tax rules."]})]}),o.errors.length>0&&(0,s.jsxs)(S.Fc,{variant:"destructive",children:[(0,s.jsx)(N.A,{className:"h-4 w-4"}),(0,s.jsx)(S.TN,{children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"font-medium",children:[o.errors.length," error(s) found:"]}),(0,s.jsx)("ul",{className:"list-disc list-inside text-sm space-y-1 max-h-32 overflow-y-auto",children:o.errors.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{children:"Excel Format Requirements"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,s.jsx)("p",{children:"Your Excel file should contain the following columns:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"product_type"}),": Product category name"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"country"}),": EU country name (exact match required)"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"vat_rate"}),": VAT percentage (0-100)"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"vat_category"}),": One of: ",T.join(", ")]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"shipping_vat_rate"}),": Shipping VAT percentage (0-100)"]})]})]})]})]})]})})};var M=a(4616),J=a(6981),P=a(5196);function I(e){let{className:t,...a}=e;return(0,s.jsx)(J.bL,{"data-slot":"checkbox",className:(0,R.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(J.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,s.jsx)(P.A,{className:"size-3.5"})})})}var L=a(1154);let z=()=>(0,s.jsx)(L.A,{className:"h-5 w-5 animate-spin"}),$=e=>{let{onAddRule:t}=e,[a,l]=(0,r.useState)(!1),[n,c]=(0,r.useState)(!1),[i,d]=(0,r.useState)(!1),[o,u]=(0,r.useState)({product_type:"",country:"",vat_rate:0,vat_category:"",shipping_vat_rate:0}),h=e=>{u(t=>({...t,vat_rate:e,shipping_vat_rate:i?t.shipping_vat_rate:e}))},m=e=>{u(t=>({...t,shipping_vat_rate:e}))},j=async()=>{if(o.product_type&&o.country&&o.vat_category)try{c(!0);let e=await V.A.post("/create/product",{product_type:o.product_type,country:o.country,vat_rate:o.vat_rate,vat_category:o.vat_category,shipping_vat_rate:o.shipping_vat_rate});t(e.data),u({product_type:"",country:"",vat_rate:0,vat_category:"",shipping_vat_rate:0}),d(!1),l(!1),k.oR.success("New tax rule for ".concat(o.product_type," in ").concat(o.country," has been added."))}catch(t){var e,a;k.oR.error((null==t||null==(a=t.response)||null==(e=a.data)?void 0:e.detail)||"Failed to create product.")}finally{c(!1)}else k.oR.error("Please fill in all required fields (Product Type, Country, and VAT Category).")};return(0,s.jsxs)(C.lG,{open:a,onOpenChange:l,children:[(0,s.jsx)(C.zM,{asChild:!0,children:(0,s.jsxs)(x.$,{className:"px-6 hover:bg-sky-700",children:[(0,s.jsx)(M.A,{className:"h-4 w-4"}),"Add Tax Rule"]})}),(0,s.jsxs)(C.Cf,{className:"max-w-md",children:[(0,s.jsx)(C.c7,{children:(0,s.jsx)(C.L3,{className:"flex items-center gap-2",children:"Add New Tax Rule"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"product-type",children:"Product Type *"}),(0,s.jsx)(p.p,{id:"product-type",placeholder:"Enter product type",value:o.product_type,onChange:e=>u(t=>({...t,product_type:e.target.value}))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"country",children:"Country *"}),(0,s.jsxs)(v.l6,{value:o.country,onValueChange:e=>u(t=>({...t,country:e})),children:[(0,s.jsx)(v.bq,{children:(0,s.jsx)(v.yv,{placeholder:"Select country"})}),(0,s.jsx)(v.gC,{children:F.map(e=>(0,s.jsx)(v.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"vat-rate",children:"VAT Rate (%)"}),(0,s.jsx)(p.p,{id:"vat-rate",type:"number",placeholder:"0",min:"0",max:"100",step:"1",value:o.vat_rate,onChange:e=>h(Number(e.target.value))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"vat-category",children:"VAT Category *"}),(0,s.jsxs)(v.l6,{value:o.vat_category,onValueChange:e=>u(t=>({...t,vat_category:e})),children:[(0,s.jsx)(v.bq,{children:(0,s.jsx)(v.yv,{placeholder:"Select category"})}),(0,s.jsx)(v.gC,{children:T.map(e=>(0,s.jsx)(v.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(I,{id:"different-shipping-rate",checked:i,onCheckedChange:e=>{d(e),e||u(e=>({...e,shipping_vat_rate:e.vat_rate}))}}),(0,s.jsx)(y.J,{htmlFor:"different-shipping-rate",className:"text-sm font-normal cursor-pointer",children:"Use different shipping VAT rate"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"shipping-vat-rate",children:"Shipping VAT Rate (%)"}),(0,s.jsx)(p.p,{id:"shipping-vat-rate",type:"number",placeholder:"0",min:"0",max:"100",step:"1",value:o.shipping_vat_rate,onChange:e=>m(Number(e.target.value)),disabled:!i,className:i?"":"bg-muted"})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end pt-4",children:[(0,s.jsx)(x.$,{variant:"outline",onClick:()=>{u({product_type:"",country:"",vat_rate:0,vat_category:"",shipping_vat_rate:0}),d(!1),l(!1)},children:"Cancel"}),(0,s.jsx)(x.$,{onClick:j,disabled:n,children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z,{}),(0,s.jsx)("span",{className:"ml-2",children:"Adding..."})]}):"Add Rule"})]})]})]})]})},q=e=>{let{rule:t,open:a,onOpenChange:l,onSaveRule:n}=e,[c,i]=(0,r.useState)(null),[d,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&i({...t,_id:t._id||t.id,id:t.id||t._id})},[t]);let u=async()=>{if(c&&c.product_type&&c.country&&c.vat_category){let a=c._id||c.id;if(!a)return void k.oR.error("Rule ID is missing. Cannot update rule.");try{o(!0);let e=await V.A.put("/update/product/".concat(a),{product_type:c.product_type,country:c.country,vat_rate:c.vat_rate,vat_category:c.vat_category,shipping_vat_rate:c.shipping_vat_rate}),t=c.id||c._id;t?(n(t,e.data),l(!1),k.oR.success("Tax rule for ".concat(c.product_type," in ").concat(c.country," has been updated."))):k.oR.error("Rule ID is missing. Cannot update rule.")}catch(a){var e,t;console.error("Update failed:",a),k.oR.error((null==a||null==(t=a.response)||null==(e=t.data)?void 0:e.detail)||"Failed to update rule.")}finally{o(!1)}}else k.oR.error("Please fill in all required fields (Product Type, Country, and VAT Category).")};return c?(0,s.jsx)(C.lG,{open:a,onOpenChange:l,children:(0,s.jsxs)(C.Cf,{className:"max-w-md",children:[(0,s.jsx)(C.c7,{children:(0,s.jsx)(C.L3,{className:"flex items-center gap-2",children:"Edit Tax Rule"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"edit-product-type",children:"Product Type *"}),(0,s.jsx)(p.p,{id:"edit-product-type",placeholder:"Enter product type",value:c.product_type,onChange:e=>i(t=>t?{...t,product_type:e.target.value}:null)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"edit-country",children:"Country *"}),(0,s.jsxs)(v.l6,{value:c.country,onValueChange:e=>i(t=>t?{...t,country:e}:null),children:[(0,s.jsx)(v.bq,{children:(0,s.jsx)(v.yv,{placeholder:"Select country"})}),(0,s.jsx)(v.gC,{children:F.map(e=>(0,s.jsx)(v.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"edit-vat-rate",children:"VAT Rate (%)"}),(0,s.jsx)(p.p,{id:"edit-vat-rate",type:"number",placeholder:"0",min:"0",max:"100",value:c.vat_rate,onChange:e=>i(t=>t?{...t,vat_rate:Number(e.target.value)}:null)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"edit-vat-category",children:"VAT Category *"}),(0,s.jsxs)(v.l6,{value:c.vat_category,onValueChange:e=>i(t=>t?{...t,vat_category:e}:null),children:[(0,s.jsx)(v.bq,{children:(0,s.jsx)(v.yv,{placeholder:"Select category"})}),(0,s.jsx)(v.gC,{children:T.map(e=>(0,s.jsx)(v.eb,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.J,{htmlFor:"edit-shipping-vat-rate",children:"Shipping VAT Rate (%)"}),(0,s.jsx)(p.p,{id:"edit-shipping-vat-rate",type:"number",placeholder:"0",min:"0",max:"100",value:c.shipping_vat_rate,onChange:e=>i(t=>t?{...t,shipping_vat_rate:Number(e.target.value)}:null)})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end pt-4",children:[(0,s.jsx)(x.$,{variant:"outline",onClick:()=>{i(t),l(!1)},children:"Cancel"}),(0,s.jsx)(x.$,{onClick:u,disabled:d,children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z,{})," ",(0,s.jsx)("span",{children:"Saving..."})]}):"Save Changes"})]})]})]})}):null};async function D(){try{let e=await V.A.get("/products");return console.log("Fetched products:",e.data.products),e.data.products}catch(a){var e,t;throw Error((null==a||null==(t=a.response)||null==(e=t.data)?void 0:e.detail)||"Failed to fetch tax rules")}}var O=a(4636);function U(e){let{rule:t,onConfirm:a,children:l,title:n="Delete Tax Rule",description:c,confirmText:i="Delete",cancelText:d="Cancel",variant:o="destructive"}=e,[u,h]=(0,r.useState)(!1);return(0,s.jsxs)(O.AM,{open:u,onOpenChange:h,children:[(0,s.jsx)(O.Wv,{asChild:!0,children:l}),(0,s.jsx)(O.hl,{className:"w-80",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium leading-none",children:n}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:c?(0,s.jsx)("p",{children:c}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["Are you sure you want to delete the tax rule for"," ",(0,s.jsx)("span",{className:"font-medium",children:t.product_type})," in"," ",(0,s.jsx)("span",{className:"font-medium",children:t.country}),"?"]}),(0,s.jsx)("p",{className:"mt-1",children:"This action cannot be undone."})]})})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)(x.$,{variant:"outline",size:"sm",onClick:()=>h(!1),children:d}),(0,s.jsx)(x.$,{variant:o,size:"sm",onClick:()=>{a(),h(!1)},children:i})]})]})})]})}let W=()=>{let[e,t]=(0,r.useState)([]),[a,f]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{try{let e=(await D()).map(e=>({...e,id:e.id||e._id,_id:e._id||e.id}));t(e)}catch(e){console.error("Failed to fetch tax rules",e),k.oR.error("Failed to load tax rules")}finally{f(!1)}})()},[e.length]);let[_,N]=(0,r.useState)(!1),[b,C]=(0,r.useState)(null),[w,R]=(0,r.useState)(!1),[A,S]=(0,r.useState)(1),[M,J]=(0,r.useState)(10),[P,I]=(0,r.useState)({search:"",country:"all",vatCategory:"all",vatRateMin:"",vatRateMax:""}),L=(0,r.useMemo)(()=>{let t=e.filter(e=>{let t=""===P.search||e.product_type.toLowerCase().includes(P.search.toLowerCase())||e.country.toLowerCase().includes(P.search.toLowerCase())||e.vat_category.toLowerCase().includes(P.search.toLowerCase()),a="all"===P.country||e.country===P.country,s="all"===P.vatCategory||e.vat_category===P.vatCategory,r=""===P.vatRateMin||e.vat_rate>=Number.parseFloat(P.vatRateMin),l=""===P.vatRateMax||e.vat_rate<=Number.parseFloat(P.vatRateMax);return t&&a&&s&&r&&l}),a=t.length,s=Math.ceil(a/M),r=(A-1)*M,l=r+M;return{data:t.slice(r,l),totalItems:a,totalPages:s,currentPage:A,hasNextPage:A<s,hasPrevPage:A>1}},[e,P,A,M]),O=(e,t)=>{I(a=>({...a,[e]:t})),S(1)},W=e=>{S(e)},B=e=>{C(e),R(!0)},G=async e=>{let a=e._id||e.id;if(!a)return void k.oR.error("Rule ID is missing. Cannot delete rule.");try{await V.A.delete("/delete/product/".concat(a)),t(t=>t.filter(t=>t.id!==e.id&&t._id!==e._id)),k.oR.success("Tax rule for ".concat(e.product_type," in ").concat(e.country," has been deleted."))}catch(e){var s,r;console.error("Delete failed:",e),k.oR.error((null==e||null==(r=e.response)||null==(s=r.data)?void 0:s.detail)||"Failed to delete tax rule.")}};return a?(0,s.jsxs)("div",{className:"flex flex-col min-h-screen items-center justify-center my-auto gap-2",children:[(0,s.jsx)(z,{}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Loading tax rules..."})]}):(0,s.jsxs)("div",{className:"w-full mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"hidden lg:flex items-center justify-center w-12 h-12 rounded-xl bg-primary/10",children:(0,s.jsx)(c.A,{className:"w-6 h-6 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Tax Settings"}),(0,s.jsx)("p",{className:"text-muted-foreground text-lg",children:"Configure VAT rates and tax rules for EU compliance and product mapping."})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)($,{onAddRule:e=>{let a=Date.now().toString();t(t=>[...t,{...e,id:a}])}}),(0,s.jsxs)(x.$,{onClick:()=>N(!0),className:"px-6 bg-slate-800 hover:bg-gray-800",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),"Import Rules"]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),L.totalItems," of ",e.length," tax rules"]})})]}),(0,s.jsx)(g.Zp,{children:(0,s.jsx)(g.Wu,{className:"px-4 py-2",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(d.A,{className:"h-4 w-4"}),(0,s.jsx)(y.J,{className:"text-base font-medium",children:"Search & Filters"}),(0,s.jsx)(x.$,{variant:"ghost",size:"sm",onClick:()=>{I({search:"",country:"all",vatCategory:"all",vatRateMin:"",vatRateMax:""}),S(1),k.oR.success("Filters cleared successfully.")},className:"ml-auto",children:"Clear All"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[(0,s.jsxs)("div",{className:"xl:col-span-2 mb-2",children:[(0,s.jsx)(y.J,{htmlFor:"search",className:"py-2",children:"Search"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(o.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(p.p,{id:"search",placeholder:"Search products, countries...",value:P.search,onChange:e=>O("search",e.target.value),className:"pl-10"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(y.J,{htmlFor:"country-filter",className:"py-2",children:"Country"}),(0,s.jsxs)(v.l6,{value:P.country,onValueChange:e=>O("country",e),children:[(0,s.jsx)(v.bq,{children:(0,s.jsx)(v.yv,{placeholder:"All countries"})}),(0,s.jsxs)(v.gC,{children:[(0,s.jsx)(v.eb,{value:"all",children:"All countries"}),F.map(e=>(0,s.jsx)(v.eb,{value:e,children:e},e))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(y.J,{htmlFor:"vat-category-filter",className:"py-2",children:"VAT Category"}),(0,s.jsxs)(v.l6,{value:P.vatCategory,onValueChange:e=>O("vatCategory",e),children:[(0,s.jsx)(v.bq,{children:(0,s.jsx)(v.yv,{placeholder:"All categories"})}),(0,s.jsxs)(v.gC,{children:[(0,s.jsx)(v.eb,{value:"all",children:"All categories"}),T.map(e=>(0,s.jsx)(v.eb,{value:e,children:e},e))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(y.J,{htmlFor:"vat-rate-min",className:"py-2",children:"Min VAT Rate (%)"}),(0,s.jsx)(p.p,{id:"vat-rate-min",type:"number",placeholder:"0",value:P.vatRateMin,onChange:e=>O("vatRateMin",e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(y.J,{htmlFor:"vat-rate-max",className:"py-2",children:"Max VAT Rate (%)"}),(0,s.jsx)(p.p,{id:"vat-rate-max",type:"number",placeholder:"100",value:P.vatRateMax,onChange:e=>O("vatRateMax",e.target.value)})]})]})]})})}),(0,s.jsx)(E,{open:_,onOpenChange:N,onImportSuccess:()=>{(async()=>{try{let e=(await D()).map(e=>({...e,id:e.id||e._id,_id:e._id||e.id}));t(e),k.oR.success("Imported tax rules and refreshed table.")}catch(e){console.error("Failed to refresh tax rules after import",e),k.oR.error("Failed to refresh tax rules after import.")}})()}}),(0,s.jsx)(q,{rule:b,open:w,onOpenChange:R,onSaveRule:(e,a)=>{t(t=>t.map(t=>t.id===e||t._id===e?{...t,...a}:t)),k.oR.success("Tax rule updated successfully.")}}),(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(m.XI,{children:[(0,s.jsx)(m.A0,{children:(0,s.jsxs)(m.Hj,{children:[(0,s.jsx)(m.nd,{children:"Product Type"}),(0,s.jsx)(m.nd,{children:"Country"}),(0,s.jsx)(m.nd,{children:"VAT Rate (%)"}),(0,s.jsx)(m.nd,{children:"VAT Category"}),(0,s.jsx)(m.nd,{children:"Shipping VAT Rate (%)"}),(0,s.jsx)(m.nd,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(m.BF,{children:L.data.length>0?L.data.map(e=>(0,s.jsxs)(m.Hj,{children:[(0,s.jsx)(m.nA,{children:e.product_type}),(0,s.jsx)(m.nA,{children:(0,s.jsx)(j.E,{variant:"outline",children:e.country})}),(0,s.jsxs)(m.nA,{children:[e.vat_rate,"%"]}),(0,s.jsx)(m.nA,{children:(0,s.jsx)(j.E,{variant:"Standard"===e.vat_category?"default":"secondary",children:e.vat_category})}),(0,s.jsxs)(m.nA,{children:[e.shipping_vat_rate,"%"]}),(0,s.jsx)(m.nA,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)(x.$,{size:"sm",variant:"outline",onClick:()=>B(e),children:(0,s.jsx)(u.A,{className:"h-4 w-4"})}),(0,s.jsx)(U,{rule:e,onConfirm:()=>G(e),children:(0,s.jsx)(x.$,{size:"sm",variant:"outline",className:"text-red-500 hover:text-red-700 hover:bg-red-50 bg-transparent",children:(0,s.jsx)(h.A,{className:"h-4 w-4"})})})]})})]},e.id||e._id)):(0,s.jsx)(m.Hj,{children:(0,s.jsx)(m.nA,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No tax rules found matching your filters."})})})]})}),L.totalPages>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between pb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y.J,{htmlFor:"items-per-page",children:"Items per page:"}),(0,s.jsxs)(v.l6,{value:M.toString(),onValueChange:e=>{J(Number.parseInt(e)),S(1)},children:[(0,s.jsx)(v.bq,{className:"w-20",children:(0,s.jsx)(v.yv,{})}),(0,s.jsxs)(v.gC,{children:[(0,s.jsx)(v.eb,{value:"5",children:"5"}),(0,s.jsx)(v.eb,{value:"10",children:"10"}),(0,s.jsx)(v.eb,{value:"20",children:"20"}),(0,s.jsx)(v.eb,{value:"50",children:"50"})]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Showing ",(A-1)*M+1," to"," ",Math.min(A*M,L.totalItems)," of"," ",L.totalItems," results"]})}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:(()=>{let e=[],{totalPages:t,currentPage:a}=L;e.push((0,s.jsx)(x.$,{variant:"outline",size:"sm",onClick:()=>W(a-1),disabled:!L.hasPrevPage,children:(0,s.jsx)(l.A,{className:"h-4 w-4"})},"prev"));let r=Math.max(1,a-2),c=Math.min(t,a+2);r>1&&(e.push((0,s.jsx)(x.$,{variant:1===a?"default":"outline",size:"sm",onClick:()=>W(1),children:"1"},1)),r>2&&e.push((0,s.jsx)("span",{className:"px-2",children:"..."},"ellipsis1")));for(let t=r;t<=c;t++)e.push((0,s.jsx)(x.$,{variant:a===t?"default":"outline",size:"sm",onClick:()=>W(t),children:t},t));return c<t&&(c<t-1&&e.push((0,s.jsx)("span",{className:"px-2",children:"..."},"ellipsis2")),e.push((0,s.jsx)(x.$,{variant:a===t?"default":"outline",size:"sm",onClick:()=>W(t),children:t},t))),e.push((0,s.jsx)(x.$,{variant:"outline",size:"sm",onClick:()=>W(a+1),disabled:!L.hasNextPage,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})},"next")),e})()})]})]})},B=()=>(0,s.jsx)("div",{className:"min-h-screen bg-background",children:(0,s.jsx)("div",{className:"px-4",children:(0,s.jsx)(W,{})})})},4636:(e,t,a)=>{"use strict";a.d(t,{AM:()=>n,Wv:()=>c,hl:()=>i});var s=a(5155);a(2115);var r=a(547),l=a(9434);function n(e){let{...t}=e;return(0,s.jsx)(r.bL,{"data-slot":"popover",...t})}function c(e){let{...t}=e;return(0,s.jsx)(r.l9,{"data-slot":"popover-trigger",...t})}function i(e){let{className:t,align:a="center",sideOffset:n=4,...c}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsx)(r.UC,{"data-slot":"popover-content",align:a,sideOffset:n,className:(0,l.cn)("bg-popover  text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md p-4 shadow-md outline-hidden",t),...c})})}},5127:(e,t,a)=>{"use strict";a.d(t,{A0:()=>n,BF:()=>c,Hj:()=>i,XI:()=>l,nA:()=>o,nd:()=>d});var s=a(5155);a(2115);var r=a(9434);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto px-4",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",t),...a})})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}},5365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>c,TN:()=>i});var s=a(5155);a(2115);var r=a(2085),l=a(9434);let n=(0,r.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,l.cn)(n({variant:a}),t),...r})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,l.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3524,4277,1290,5152,3656,6671,2782,3765,3209,8441,1684,7358],()=>t(1816)),_N_E=e.O()}]);